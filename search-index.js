crystal_doc_search_index_callback({"repository_name":"lucky_search","body":"# lucky_search\nThis is a WIP - feel free to help out!\n\n\nEasy plugin and play elasticsearch library for Lucky framework. Highly inspired by [Searchkick](https://github.com/ankane/searchkick) but are still lacking some of the advanced features searchkick have. Now you can just index and search.\n\nI also got a lot of help and borrowed code from [neuroplastic](https://github.com/place-labs/neuroplastic) - Thank you Place Labs!\nI also borrowed some of the analysis from Searchkick to get stemming and so on. Thank you Searchkick!\n\n## Installation\n\n1. Add the dependency to your `shard.yml`:\n\n   ```yaml\n   dependencies:\n     lucky_search:\n       github: confact/lucky_search\n   ```\n\n2. Run `shards install`\n\n## Usage\n\n```crystal\nrequire \"lucky_search\"\n```\nto the shards.cr\n\n### Operations and Model\nAdd `include Searchable` to the operations for the models you want to add to elaticsearch. It adds hooks to update the index on saves and delete on delete.\n\n\nYou also need to have a `search_data` method in the model class that returns an hash of data you want to index. Example:\n```crystal\n\ndef search_data\n  {\n    \"name\" => name,\n    \"last_campaign\" => get_last_campaign,\n    \"age\" => age\n  }\nend\n``` \n\nRight now it has to be an flat data (no hash in the hash)\n\nindex all your data:\n```\nlucky search:reindex user\n```\n\n### Query\nTo do searches we use Lucky's query classes. We created a macro to generate methods for you.\n\nUse existing query or create a new `SearchUser` query class.\n\nadd `luckySearchQuery(model)` to the class, example below:\n\n```crystal\nclass UserQuery < Event::BaseQuery\n  luckySearchQuery(Event)\nend\n``` \n\nYou can now search by: `UserQuery.search(\"name\")`\n\n## Development\n\ninstall elasticsearch and the shards by `shards install`\nrun the tests with `crystal spec` \n\n## Contributing\n\n1. Fork it (<https://github.com/confact/lucky_search/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n\n## Contributors\n\n- [Håkan Nylén](https://github.com/confact) - creator and maintainer\n","program":{"html_id":"lucky_search/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"lucky_search","program":true,"enum":false,"alias":false,"const":false,"macros":[{"html_id":"luckySearchQuery(model)-macro","name":"luckySearchQuery","abstract":false,"args":[{"name":"model","external_name":"model","restriction":""}],"args_string":"(model)","args_html":"(model)","location":{"filename":"src/lucky_search.cr","line_number":9,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search.cr#L9"},"def":{"name":"luckySearchQuery","args":[{"name":"model","external_name":"model","restriction":""}],"visibility":"Public","body":"  class_getter(lucky_search_handler) \n{ LuckySearch::SimpleQuery(\n{{ @type }}\n, \n{{ model }}\n).new(\n{{ model }}\n.class.name)) }\n  def self.search(q : String, params = \n{} of Symbol => String, filters = nil)\n    query = lucky_search_handler.query(q, params, filters)\n    lucky_search_handler.search(query)\n  \nend\n  def self.search(params = \n{} of Symbol => String, filters = nil)\n    query = lucky_search_handler.query(params, filters)\n    lucky_search_handler.search(query)\n  \nend\n\n  def self.search_query(q : String, params = \n{} of Symbol => String, filters = nil)\n    lucky_search_handler.query(q, params, filters)\n  \nend\n\n  def self.search_query(params = \n{} of Symbol => String, filters = nil)\n    lucky_search_handler.query(params, filters)\n  \nend\n\n  def self.search(query : LuckySearch::Query)\n    lucky_search_handler.search(query)\n  \nend\n\n  def self.search_query_build\n    lucky_search_handler.query.build\n  \nend\n\n"}}],"types":[{"html_id":"lucky_search/LuckySearch","path":"LuckySearch.html","kind":"module","full_name":"LuckySearch","name":"LuckySearch","abstract":false,"locations":[{"filename":"src/lucky_search.cr","line_number":5,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search.cr#L5"},{"filename":"src/lucky_search/elastic.cr","line_number":6,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L6"},{"filename":"src/lucky_search/query.cr","line_number":1,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L1"},{"filename":"src/lucky_search/schema.cr","line_number":1,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L1"},{"filename":"src/lucky_search/types.cr","line_number":1,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/types.cr#L1"},{"filename":"src/lucky_search/utils.cr","line_number":1,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/utils.cr#L1"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"\"0.1.0\""}],"types":[{"html_id":"lucky_search/LuckySearch/Elastic","path":"LuckySearch/Elastic.html","kind":"class","full_name":"LuckySearch::Elastic","name":"Elastic","abstract":false,"superclass":{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"lucky_search/Habitat/SettingsHelpers","kind":"module","full_name":"Habitat::SettingsHelpers","name":"SettingsHelpers"},{"html_id":"lucky_search/Habitat/TempConfig","kind":"module","full_name":"Habitat::TempConfig","name":"TempConfig"},{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/elastic.cr","line_number":6,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L6"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"HABITAT_SETTINGS","name":"HABITAT_SETTINGS","value":"[{decl: uri : URI | ::Nil = (Elastic.env_with_deprecation(\"ELASTIC_URI\", \"ES_URI\")).try(&->URI.parse(String)), example: nil, validation: nil}, {decl: host : String = (Elastic.env_with_deprecation(\"ELASTIC_HOST\", \"ES_HOST\")) || \"127.0.0.1\", example: nil, validation: nil}, {decl: port : Int32 = (Elastic.env_with_deprecation(\"ELASTIC_PORT\", \"ES_PORT\")).try(&.to_i) || 9200, example: nil, validation: nil}, {decl: tls : Bool = (Elastic.env_with_deprecation(\"ELASTIC_TLS\", \"ES_TLS\")) == \"true\", example: nil, validation: nil}, {decl: pooled : Bool = (Elastic.env_with_deprecation(\"ELASTIC_POOLED\", \"ES_POOLED\")) == \"true\", example: nil, validation: nil}, {decl: pool_size : Int32 = (Elastic.env_with_deprecation(\"ELASTIC_CONN_POOL\", \"ES_CONN_POOL\")).try(&.to_i) || NUM_INDICES, example: nil, validation: nil}, {decl: idle_pool_size : Int32 = (Elastic.env_with_deprecation(\"ELASTIC_IDLE_POOL\", \"ES_IDLE_POOL\")).try(&.to_i) || (NUM_INDICES // 4), example: nil, validation: nil}, {decl: pool_timeout : Float64 = (Elastic.env_with_deprecation(\"ELASTIC_CONN_POOL_TIMEOUT\", \"ES_CONN_POOL_TIMEOUT\")).try(&.to_f64) || 5.0, example: nil, validation: nil}] of Nil"},{"id":"NUM_INDICES","name":"NUM_INDICES","value":"10"}],"included_modules":[{"html_id":"lucky_search/Habitat/SettingsHelpers","kind":"module","full_name":"Habitat::SettingsHelpers","name":"SettingsHelpers"},{"html_id":"lucky_search/Habitat/TempConfig","kind":"module","full_name":"Habitat::TempConfig","name":"TempConfig"}],"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"doc":"borrowed from Neuroplastic - thank you Place Labs","summary":"<p>borrowed from Neuroplastic - thank you Place Labs</p>","class_methods":[{"html_id":"configure(&)-class-method","name":"configure","abstract":false,"location":{"filename":"src/lucky_search/elastic.cr","line_number":10,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L10"},"def":{"name":"configure","yields":1,"visibility":"Public","body":"yield settings"}},{"html_id":"settings-class-method","name":"settings","abstract":false,"location":{"filename":"src/lucky_search/elastic.cr","line_number":10,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L10"},"def":{"name":"settings","visibility":"Public","body":"HabitatSettings"}}],"instance_methods":[{"html_id":"count(arguments={}ofSymbol=>String)-instance-method","name":"count","abstract":false,"args":[{"name":"arguments","default_value":"{} of Symbol => String","external_name":"arguments","restriction":""}],"args_string":"(arguments = {} of Symbol => String)","args_html":"(arguments = {} <span class=\"k\">of</span> <span class=\"t\">Symbol</span> =&gt; <span class=\"t\">String</span>)","location":{"filename":"src/lucky_search/elastic.cr","line_number":103,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L103"},"def":{"name":"count","args":[{"name":"arguments","default_value":"{} of Symbol => String","external_name":"arguments","restriction":""}],"visibility":"Public","body":"valid_params = [:allow_no_indices, :analyze_wildcard, :analyzer, :default_operator, :df, :expand_wildcards, :ignore_unavailable, :lenient, :lowercase_expanded_terms, :min_score, :preference, :q, :routing]\nindex = arguments[:index]? || \"_all\"\nif index.is_a?(Array(String))\n  index = index.join(',')\nend\npath = \"/#{index}/_count\"\nmethod = \"POST\"\nbody = arguments[:body]?\nparams = arguments.to_h.select(valid_params)\nperform_request(method: method, path: path, params: params, body: body)\n"}},{"html_id":"create(index,body)-instance-method","name":"create","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""},{"name":"body","external_name":"body","restriction":""}],"args_string":"(index, body)","args_html":"(index, body)","location":{"filename":"src/lucky_search/elastic.cr","line_number":144,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L144"},"def":{"name":"create","args":[{"name":"index","external_name":"index","restriction":""},{"name":"body","external_name":"body","restriction":""}],"visibility":"Public","body":"path = \"/#{index}/_doc\"\nmethod = \"POST\"\nperform_request(method: method, path: path, body: body)\n"}},{"html_id":"create_index(index,body)-instance-method","name":"create_index","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""},{"name":"body","external_name":"body","restriction":""}],"args_string":"(index, body)","args_html":"(index, body)","location":{"filename":"src/lucky_search/elastic.cr","line_number":172,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L172"},"def":{"name":"create_index","args":[{"name":"index","external_name":"index","restriction":""},{"name":"body","external_name":"body","restriction":""}],"visibility":"Public","body":"path = \"/#{index}\"\nmethod = \"PUT\"\nperform_request(method: method, path: path, body: body)\n"}},{"html_id":"delete(index,id)-instance-method","name":"delete","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""},{"name":"id","external_name":"id","restriction":""}],"args_string":"(index, id)","args_html":"(index, id)","location":{"filename":"src/lucky_search/elastic.cr","line_number":137,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L137"},"def":{"name":"delete","args":[{"name":"index","external_name":"index","restriction":""},{"name":"id","external_name":"id","restriction":""}],"visibility":"Public","body":"path = \"/#{index}/_doc/#{id}\"\nmethod = \"DELETE\"\nperform_request(method: method, path: path)\n"}},{"html_id":"delete_index(index)-instance-method","name":"delete_index","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""}],"args_string":"(index)","args_html":"(index)","location":{"filename":"src/lucky_search/elastic.cr","line_number":165,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L165"},"def":{"name":"delete_index","args":[{"name":"index","external_name":"index","restriction":""}],"visibility":"Public","body":"path = \"/#{index}\"\nmethod = \"DELETE\"\nperform_request(method: method, path: path)\n"}},{"html_id":"exists?(index,id):Bool-instance-method","name":"exists?","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""},{"name":"id","external_name":"id","restriction":""}],"args_string":"(index, id) : Bool","args_html":"(index, id) : Bool","location":{"filename":"src/lucky_search/elastic.cr","line_number":130,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L130"},"def":{"name":"exists?","args":[{"name":"index","external_name":"index","restriction":""},{"name":"id","external_name":"id","restriction":""}],"return_type":"Bool","visibility":"Public","body":"path = \"/#{index}/_doc/#{id}\"\nmethod = \"HEAD\"\nperform_request_bool(method: method, path: path)\n"}},{"html_id":"index_exists?(index):Bool-instance-method","name":"index_exists?","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""}],"args_string":"(index) : Bool","args_html":"(index) : Bool","location":{"filename":"src/lucky_search/elastic.cr","line_number":158,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L158"},"def":{"name":"index_exists?","args":[{"name":"index","external_name":"index","restriction":""}],"return_type":"Bool","visibility":"Public","body":"path = \"/#{index}\"\nmethod = \"HEAD\"\nperform_request_bool(method: method, path: path)\n"}},{"html_id":"perform_request(method,path,params=nil,body=nil):JSON::Any-instance-method","name":"perform_request","abstract":false,"args":[{"name":"method","external_name":"method","restriction":""},{"name":"path","external_name":"path","restriction":""},{"name":"params","default_value":"nil","external_name":"params","restriction":""},{"name":"body","default_value":"nil","external_name":"body","restriction":""}],"args_string":"(method, path, params = nil, body = nil) : JSON::Any","args_html":"(method, path, params = <span class=\"n\">nil</span>, body = <span class=\"n\">nil</span>) : JSON::Any","location":{"filename":"src/lucky_search/elastic.cr","line_number":179,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L179"},"def":{"name":"perform_request","args":[{"name":"method","external_name":"method","restriction":""},{"name":"path","external_name":"path","restriction":""},{"name":"params","default_value":"nil","external_name":"params","restriction":""},{"name":"body","default_value":"nil","external_name":"body","restriction":""}],"return_type":"JSON::Any","visibility":"Public","body":"post_body = body.try(&.to_json)\nresponse = case method.upcase\nwhen \"GET\"\n  endpoint = \"#{path}?#{normalize_params(params)}\"\n  if post_body\n    Elastic.client(&.get(path: endpoint, body: post_body, headers: JSON_HEADER))\n  else\n    Elastic.client(&.get(path: endpoint))\n  end\nwhen \"POST\"\n  Elastic.client(&.post(path: path, body: post_body, headers: JSON_HEADER))\nwhen \"PUT\"\n  Elastic.client(&.put(path: path, body: post_body, headers: JSON_HEADER))\nwhen \"DELETE\"\n  endpoint = \"#{path}?#{normalize_params(params)}\"\n  Elastic.client(&.delete(path: endpoint))\nwhen \"HEAD\"\n  Elastic.client(&.head(path: path))\nelse\n  raise(\"Unsupported method: #{method}\")\nend\nif response.success?\n  JSON.parse(response.body)\nelse\n  raise(Error::ElasticQueryError.new(\"ES error: #{response.status_code}\\n#{response.body}\"))\nend\n"}},{"html_id":"perform_request_bool(method,path,params=nil,body=nil):Bool-instance-method","name":"perform_request_bool","abstract":false,"args":[{"name":"method","external_name":"method","restriction":""},{"name":"path","external_name":"path","restriction":""},{"name":"params","default_value":"nil","external_name":"params","restriction":""},{"name":"body","default_value":"nil","external_name":"body","restriction":""}],"args_string":"(method, path, params = nil, body = nil) : Bool","args_html":"(method, path, params = <span class=\"n\">nil</span>, body = <span class=\"n\">nil</span>) : Bool","location":{"filename":"src/lucky_search/elastic.cr","line_number":209,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L209"},"def":{"name":"perform_request_bool","args":[{"name":"method","external_name":"method","restriction":""},{"name":"path","external_name":"path","restriction":""},{"name":"params","default_value":"nil","external_name":"params","restriction":""},{"name":"body","default_value":"nil","external_name":"body","restriction":""}],"return_type":"Bool","visibility":"Public","body":"post_body = body.try(&.to_json)\nresponse = case method.upcase\nwhen \"GET\"\n  endpoint = \"#{path}?#{normalize_params(params)}\"\n  if post_body\n    Elastic.client(&.get(path: endpoint, body: post_body, headers: JSON_HEADER))\n  else\n    Elastic.client(&.get(path: endpoint))\n  end\nwhen \"POST\"\n  Elastic.client(&.post(path: path, body: post_body, headers: JSON_HEADER))\nwhen \"PUT\"\n  Elastic.client(&.put(path: path, body: post_body, headers: JSON_HEADER))\nwhen \"DELETE\"\n  endpoint = \"#{path}?#{normalize_params(params)}\"\n  Elastic.client(&.delete(path: endpoint))\nwhen \"HEAD\"\n  Elastic.client(&.head(path: path))\nelse\n  raise(\"Unsupported method: #{method}\")\nend\nresponse.success?\n"}},{"html_id":"search(arguments={}ofSymbol=>String):JSON::Any-instance-method","name":"search","abstract":false,"args":[{"name":"arguments","default_value":"{} of Symbol => String","external_name":"arguments","restriction":""}],"args_string":"(arguments = {} of Symbol => String) : JSON::Any","args_html":"(arguments = {} <span class=\"k\">of</span> <span class=\"t\">Symbol</span> =&gt; <span class=\"t\">String</span>) : JSON::Any","location":{"filename":"src/lucky_search/elastic.cr","line_number":36,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L36"},"def":{"name":"search","args":[{"name":"arguments","default_value":"{} of Symbol => String","external_name":"arguments","restriction":""}],"return_type":"JSON::Any","visibility":"Public","body":"valid_params = [:_source, :_source_exclude, :_source_include, :allow_no_indices, :analyze_wildcard, :analyzer, :batched_reduce_size, :default_operator, :df, :docvalue_fields, :expand_wildcards, :explain, :fielddata_fields, :fields, :from, :ignore_indices, :ignore_unavailable, :lenient, :lowercase_expanded_terms, :preference, :q, :query_cache, :request_cache, :routing, :scroll, :search_type, :size, :sort, :source, :stats, :stored_fields, :suggest_field, :suggest_mode, :suggest_size, :suggest_text, :terminate_after, :timeout, :typed_keys, :version]\nindex = arguments[:index]? || \"_all\"\npath = \"/#{index}/_search\"\nmethod = \"POST\"\nbody = arguments[:body]?\nparams = arguments.to_h.select(valid_params)\nfields = arguments[:fields]?\nif fields\n  if fields.is_a?(Array)\n  else\n    fields = [fields]\n  end\n  params[:fields] = fields.map(&.to_s).join(',')\nend\nfielddata_fields = arguments[:fielddata_fields]?\nif fielddata_fields\n  if fielddata_fields.is_a?(Array)\n  else\n    fielddata_fields = [fielddata_fields]\n  end\n  params[:fielddata_fields] = fielddata_fields.map(&.to_s).join(',')\nend\nLog.debug do\n  \"performing search: params=#{params} body=#{body.to_json}\"\nend\nperform_request(method: method, path: path, params: params, body: body)\n"}},{"html_id":"settings-instance-method","name":"settings","abstract":false,"location":{"filename":"src/lucky_search/elastic.cr","line_number":10,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L10"},"def":{"name":"settings","visibility":"Public","body":"HabitatSettings"}},{"html_id":"update(index,id,body)-instance-method","name":"update","abstract":false,"args":[{"name":"index","external_name":"index","restriction":""},{"name":"id","external_name":"id","restriction":""},{"name":"body","external_name":"body","restriction":""}],"args_string":"(index, id, body)","args_html":"(index, id, body)","location":{"filename":"src/lucky_search/elastic.cr","line_number":151,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L151"},"def":{"name":"update","args":[{"name":"index","external_name":"index","restriction":""},{"name":"id","external_name":"id","restriction":""},{"name":"body","external_name":"body","restriction":""}],"visibility":"Public","body":"path = \"/#{index}/_doc/#{id}\"\nmethod = \"PUT\"\nperform_request(method: method, path: path, body: body)\n"}}],"types":[{"html_id":"lucky_search/LuckySearch/Elastic/HabitatSettings","path":"LuckySearch/Elastic/HabitatSettings.html","kind":"class","full_name":"LuckySearch::Elastic::HabitatSettings","name":"HabitatSettings","abstract":false,"superclass":{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/elastic.cr","line_number":10,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/elastic.cr#L10"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Elastic","kind":"class","full_name":"LuckySearch::Elastic","name":"Elastic"},"class_methods":[{"html_id":"host:String-class-method","name":"host","abstract":false,"def":{"name":"host","return_type":"String","visibility":"Public","body":"@@host.not_nil!"}},{"html_id":"host=(value:String)-class-method","name":"host=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"String"}],"args_string":"(value : String)","args_html":"(value : String)","def":{"name":"host=","args":[{"name":"value","external_name":"value","restriction":"String"}],"visibility":"Public","body":"@@host = value"}},{"html_id":"host?-class-method","name":"host?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use host in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use host in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"host?","visibility":"Public","body":"@@host"}},{"html_id":"idle_pool_size:Int32-class-method","name":"idle_pool_size","abstract":false,"def":{"name":"idle_pool_size","return_type":"Int32","visibility":"Public","body":"@@idle_pool_size.not_nil!"}},{"html_id":"idle_pool_size=(value:Int32)-class-method","name":"idle_pool_size=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Int32"}],"args_string":"(value : Int32)","args_html":"(value : Int32)","def":{"name":"idle_pool_size=","args":[{"name":"value","external_name":"value","restriction":"Int32"}],"visibility":"Public","body":"@@idle_pool_size = value"}},{"html_id":"idle_pool_size?-class-method","name":"idle_pool_size?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use idle_pool_size in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use idle_pool_size in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"idle_pool_size?","visibility":"Public","body":"@@idle_pool_size"}},{"html_id":"pool_size:Int32-class-method","name":"pool_size","abstract":false,"def":{"name":"pool_size","return_type":"Int32","visibility":"Public","body":"@@pool_size.not_nil!"}},{"html_id":"pool_size=(value:Int32)-class-method","name":"pool_size=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Int32"}],"args_string":"(value : Int32)","args_html":"(value : Int32)","def":{"name":"pool_size=","args":[{"name":"value","external_name":"value","restriction":"Int32"}],"visibility":"Public","body":"@@pool_size = value"}},{"html_id":"pool_size?-class-method","name":"pool_size?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use pool_size in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use pool_size in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"pool_size?","visibility":"Public","body":"@@pool_size"}},{"html_id":"pool_timeout:Float64-class-method","name":"pool_timeout","abstract":false,"def":{"name":"pool_timeout","return_type":"Float64","visibility":"Public","body":"@@pool_timeout.not_nil!"}},{"html_id":"pool_timeout=(value:Float64)-class-method","name":"pool_timeout=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Float64"}],"args_string":"(value : Float64)","args_html":"(value : Float64)","def":{"name":"pool_timeout=","args":[{"name":"value","external_name":"value","restriction":"Float64"}],"visibility":"Public","body":"@@pool_timeout = value"}},{"html_id":"pool_timeout?-class-method","name":"pool_timeout?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use pool_timeout in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use pool_timeout in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"pool_timeout?","visibility":"Public","body":"@@pool_timeout"}},{"html_id":"pooled:Bool-class-method","name":"pooled","abstract":false,"def":{"name":"pooled","return_type":"Bool","visibility":"Public","body":"@@pooled.not_nil!"}},{"html_id":"pooled=(value:Bool)-class-method","name":"pooled=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Bool"}],"args_string":"(value : Bool)","args_html":"(value : Bool)","def":{"name":"pooled=","args":[{"name":"value","external_name":"value","restriction":"Bool"}],"visibility":"Public","body":"@@pooled = value"}},{"html_id":"pooled?-class-method","name":"pooled?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use pooled in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use pooled in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"pooled?","visibility":"Public","body":"@@pooled"}},{"html_id":"port:Int32-class-method","name":"port","abstract":false,"def":{"name":"port","return_type":"Int32","visibility":"Public","body":"@@port.not_nil!"}},{"html_id":"port=(value:Int32)-class-method","name":"port=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Int32"}],"args_string":"(value : Int32)","args_html":"(value : Int32)","def":{"name":"port=","args":[{"name":"value","external_name":"value","restriction":"Int32"}],"visibility":"Public","body":"@@port = value"}},{"html_id":"port?-class-method","name":"port?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use port in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use port in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"port?","visibility":"Public","body":"@@port"}},{"html_id":"tls:Bool-class-method","name":"tls","abstract":false,"def":{"name":"tls","return_type":"Bool","visibility":"Public","body":"@@tls.not_nil!"}},{"html_id":"tls=(value:Bool)-class-method","name":"tls=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Bool"}],"args_string":"(value : Bool)","args_html":"(value : Bool)","def":{"name":"tls=","args":[{"name":"value","external_name":"value","restriction":"Bool"}],"visibility":"Public","body":"@@tls = value"}},{"html_id":"tls?-class-method","name":"tls?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use tls in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use tls in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"tls?","visibility":"Public","body":"@@tls"}},{"html_id":"to_h-class-method","name":"to_h","doc":"Generates a hash using the provided values","summary":"<p>Generates a hash using the provided values</p>","abstract":false,"def":{"name":"to_h","visibility":"Public","body":"{\"uri\" => uri, \"host\" => host, \"port\" => port, \"tls\" => tls, \"pooled\" => pooled, \"pool_size\" => pool_size, \"idle_pool_size\" => idle_pool_size, \"pool_timeout\" => pool_timeout}"}},{"html_id":"uri:URI?-class-method","name":"uri","abstract":false,"def":{"name":"uri","return_type":"URI | ::Nil","visibility":"Public","body":"@@uri"}},{"html_id":"uri=(value:URI?)-class-method","name":"uri=","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"URI | ::Nil"}],"args_string":"(value : URI?)","args_html":"(value : URI?)","def":{"name":"uri=","args":[{"name":"value","external_name":"value","restriction":"URI | ::Nil"}],"visibility":"Public","body":"@@uri = value"}},{"html_id":"uri?-class-method","name":"uri?","doc":"Used for checking missing settings on non-nilable types\nIt's advised to use uri in your apps to ensure\nthe propper type is checked.","summary":"<p>Used for checking missing settings on non-nilable types It's advised to use uri in your apps to ensure the propper type is checked.</p>","abstract":false,"def":{"name":"uri?","visibility":"Public","body":"@@uri"}}]}]},{"html_id":"lucky_search/LuckySearch/Error","path":"LuckySearch/Error.html","kind":"class","full_name":"LuckySearch::Error","name":"Error","abstract":false,"superclass":{"html_id":"lucky_search/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"lucky_search/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/error.cr","line_number":1,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/error.cr#L1"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"lucky_search/LuckySearch/Error/ElasticQueryError","kind":"class","full_name":"LuckySearch::Error::ElasticQueryError","name":"ElasticQueryError"},{"html_id":"lucky_search/LuckySearch/Error/MalformedQuery","kind":"class","full_name":"LuckySearch::Error::MalformedQuery","name":"MalformedQuery"}],"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"constructors":[{"html_id":"new(message:String?=\"\")-class-method","name":"new","abstract":false,"args":[{"name":"message","default_value":"\"\"","external_name":"message","restriction":"String | ::Nil"}],"args_string":"(message : String? = \"\")","args_html":"(message : String? = <span class=\"s\">&quot;&quot;</span>)","location":{"filename":"src/lucky_search/error.cr","line_number":4,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/error.cr#L4"},"def":{"name":"new","args":[{"name":"message","default_value":"\"\"","external_name":"message","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(message)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"message:String?-instance-method","name":"message","abstract":false,"location":{"filename":"src/lucky_search/error.cr","line_number":2,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/error.cr#L2"},"def":{"name":"message","visibility":"Public","body":"@message"}}],"types":[{"html_id":"lucky_search/LuckySearch/Error/ElasticQueryError","path":"LuckySearch/Error/ElasticQueryError.html","kind":"class","full_name":"LuckySearch::Error::ElasticQueryError","name":"ElasticQueryError","abstract":false,"superclass":{"html_id":"lucky_search/LuckySearch/Error","kind":"class","full_name":"LuckySearch::Error","name":"Error"},"ancestors":[{"html_id":"lucky_search/LuckySearch/Error","kind":"class","full_name":"LuckySearch::Error","name":"Error"},{"html_id":"lucky_search/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/error.cr","line_number":11,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/error.cr#L11"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Error","kind":"class","full_name":"LuckySearch::Error","name":"Error"}},{"html_id":"lucky_search/LuckySearch/Error/MalformedQuery","path":"LuckySearch/Error/MalformedQuery.html","kind":"class","full_name":"LuckySearch::Error::MalformedQuery","name":"MalformedQuery","abstract":false,"superclass":{"html_id":"lucky_search/LuckySearch/Error","kind":"class","full_name":"LuckySearch::Error","name":"Error"},"ancestors":[{"html_id":"lucky_search/LuckySearch/Error","kind":"class","full_name":"LuckySearch::Error","name":"Error"},{"html_id":"lucky_search/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/error.cr","line_number":8,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/error.cr#L8"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Error","kind":"class","full_name":"LuckySearch::Error","name":"Error"}}]},{"html_id":"lucky_search/LuckySearch/Query","path":"LuckySearch/Query.html","kind":"class","full_name":"LuckySearch::Query","name":"Query","abstract":false,"superclass":{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/query.cr","line_number":2,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L2"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"RANGE_PARAMS","name":"RANGE_PARAMS","value":"{:gte, :gt, :lte, :lt, :boost}"}],"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"class_methods":[{"html_id":"document_name(klass:Class):String-class-method","name":"document_name","abstract":false,"args":[{"name":"klass","external_name":"klass","restriction":"Class"}],"args_string":"(klass : Class) : String","args_html":"(klass : Class) : String","location":{"filename":"src/lucky_search/query.cr","line_number":38,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L38"},"def":{"name":"document_name","args":[{"name":"klass","external_name":"klass","restriction":"Class"}],"return_type":"String","visibility":"Public","body":"(klass.name.split(\"::\")).last"}}],"constructors":[{"html_id":"new(params:HTTP::Params|Hash(String,String)|Hash(Symbol,String)={}ofString=>String)-class-method","name":"new","abstract":false,"args":[{"name":"params","default_value":"{} of String => String","external_name":"params","restriction":"HTTP::Params | Hash(String, String) | Hash(Symbol, String)"}],"args_string":"(params : HTTP::Params | Hash(String, String) | Hash(Symbol, String) = {} of String => String)","args_html":"(params : HTTP::Params | Hash(String, String) | Hash(Symbol, String) = {} <span class=\"k\">of</span> <span class=\"t\">String</span> =&gt; <span class=\"t\">String</span>)","location":{"filename":"src/lucky_search/query.cr","line_number":19,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L19"},"def":{"name":"new","args":[{"name":"params","default_value":"{} of String => String","external_name":"params","restriction":"HTTP::Params | Hash(String, String) | Hash(Symbol, String)"}],"visibility":"Public","body":"_ = allocate\n_.initialize(params)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"html_id":"new(search:String,limit:Int32=100,offset:Int32=0)-class-method","name":"new","abstract":false,"args":[{"name":"search","external_name":"search","restriction":"String"},{"name":"limit","default_value":"100","external_name":"limit","restriction":"Int32"},{"name":"offset","default_value":"0","external_name":"offset","restriction":"Int32"}],"args_string":"(search : String, limit : Int32 = 100, offset : Int32 = 0)","args_html":"(search : String, limit : Int32 = <span class=\"n\">100</span>, offset : Int32 = <span class=\"n\">0</span>)","location":{"filename":"src/lucky_search/query.cr","line_number":32,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L32"},"def":{"name":"new","args":[{"name":"search","external_name":"search","restriction":"String"},{"name":"limit","default_value":"100","external_name":"limit","restriction":"Int32"},{"name":"offset","default_value":"0","external_name":"offset","restriction":"Int32"}],"visibility":"Public","body":"_ = allocate\n_.initialize(search, limit, offset)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"build-instance-method","name":"build","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":164,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L164"},"def":{"name":"build","visibility":"Public","body":"{query: build_query, filter: build_filter, offset: offset, limit: limit, sort: sort}"}},{"html_id":"child:String?-instance-method","name":"child","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":47,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L47"},"def":{"name":"child","return_type":"String | ::Nil","visibility":"Public","body":"@child"}},{"html_id":"exists(*fields)-instance-method","name":"exists","abstract":false,"args":[{"name":"fields","external_name":"fields","restriction":""}],"args_string":"(*fields)","args_html":"(*fields)","location":{"filename":"src/lucky_search/query.cr","line_number":158,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L158"},"def":{"name":"exists","args":[{"name":"fields","external_name":"fields","restriction":""}],"splat_index":0,"visibility":"Public","body":"@exists || (@exists = Set(String).new)\n@exists.concat(fields)\nself\n"}},{"html_id":"fields:Array(String)-instance-method","name":"fields","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":17,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L17"},"def":{"name":"fields","return_type":"Array(String)","visibility":"Public","body":"@fields"}},{"html_id":"filter(filters:Filter)-instance-method","name":"filter","abstract":false,"args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"args_string":"(filters : Filter)","args_html":"(filters : <a href=\"../LuckySearch/Query/Filter.html\">Filter</a>)","location":{"filename":"src/lucky_search/query.cr","line_number":91,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L91"},"def":{"name":"filter","args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"visibility":"Public","body":"self.filters.merge!(filters)\nself\n"}},{"html_id":"filters:Filter-instance-method","name":"filters","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":71,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L71"},"def":{"name":"filters","return_type":"Filter","visibility":"Public","body":"if (value = @filters).nil?\n  @filters = (Filter.new)\nelse\n  value\nend"}},{"html_id":"has_child(child:Class)-instance-method","name":"has_child","doc":"Applies the query to child objects","summary":"<p>Applies the query to child objects</p>","abstract":false,"args":[{"name":"child","external_name":"child","restriction":"Class"}],"args_string":"(child : Class)","args_html":"(child : Class)","location":{"filename":"src/lucky_search/query.cr","line_number":52,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L52"},"def":{"name":"has_child","args":[{"name":"child","external_name":"child","restriction":"Class"}],"visibility":"Public","body":"@child = Query.document_name(child)\nself\n"}},{"html_id":"has_parent(parent:Class,parent_index:String)-instance-method","name":"has_parent","doc":"\"has_parent\" query.\n\nSets the index to the parent","summary":"<p>&quot;has_parent&quot; query.</p>","abstract":false,"args":[{"name":"parent","external_name":"parent","restriction":"Class"},{"name":"parent_index","external_name":"parent_index","restriction":"String"}],"args_string":"(parent : Class, parent_index : String)","args_html":"(parent : Class, parent_index : String)","location":{"filename":"src/lucky_search/query.cr","line_number":61,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L61"},"def":{"name":"has_parent","args":[{"name":"parent","external_name":"parent","restriction":"Class"},{"name":"parent_index","external_name":"parent_index","restriction":"String"}],"visibility":"Public","body":"@parent = Query.document_name(parent)\n@index = parent_index\nself\n"}},{"html_id":"index:String?-instance-method","name":"index","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":49,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L49"},"def":{"name":"index","return_type":"String | ::Nil","visibility":"Public","body":"@index"}},{"html_id":"limit:Int32-instance-method","name":"limit","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":11,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L11"},"def":{"name":"limit","return_type":"Int32","visibility":"Public","body":"@limit"}},{"html_id":"missing(*fields)-instance-method","name":"missing","doc":"Call to add fields that should be missing\nEffectively adds a filter that ensures a field is missing","summary":"<p>Call to add fields that should be missing Effectively adds a filter that ensures a field is missing</p>","abstract":false,"args":[{"name":"fields","external_name":"fields","restriction":""}],"args_string":"(*fields)","args_html":"(*fields)","location":{"filename":"src/lucky_search/query.cr","line_number":152,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L152"},"def":{"name":"missing","args":[{"name":"fields","external_name":"fields","restriction":""}],"splat_index":0,"visibility":"Public","body":"@missing || (@missing = Set(String).new)\n@missing.concat(fields)\nself\n"}},{"html_id":"must(filters:Filter)-instance-method","name":"must","doc":"Like filter, but all hits must match each filter","summary":"<p>Like filter, but all hits must match each filter</p>","abstract":false,"args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"args_string":"(filters : Filter)","args_html":"(filters : <a href=\"../LuckySearch/Query/Filter.html\">Filter</a>)","location":{"filename":"src/lucky_search/query.cr","line_number":105,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L105"},"def":{"name":"must","args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"visibility":"Public","body":"self.must.merge!(filters)\nself\n"}},{"html_id":"must:Filter-instance-method","name":"must","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":83,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L83"},"def":{"name":"must","return_type":"Filter","visibility":"Public","body":"if (value = @must).nil?\n  @must = (Filter.new)\nelse\n  value\nend"}},{"html_id":"must_not(filters:Filter)-instance-method","name":"must_not","doc":"The opposite of filter, essentially a not","summary":"<p>The opposite of filter, essentially a not</p>","abstract":false,"args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"args_string":"(filters : Filter)","args_html":"(filters : <a href=\"../LuckySearch/Query/Filter.html\">Filter</a>)","location":{"filename":"src/lucky_search/query.cr","line_number":112,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L112"},"def":{"name":"must_not","args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"visibility":"Public","body":"self.must_not.merge!(filters)\nself\n"}},{"html_id":"must_not:Filter-instance-method","name":"must_not","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":79,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L79"},"def":{"name":"must_not","return_type":"Filter","visibility":"Public","body":"if (value = @must_not).nil?\n  @must_not = (Filter.new)\nelse\n  value\nend"}},{"html_id":"offset:Int32-instance-method","name":"offset","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":9,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L9"},"def":{"name":"offset","return_type":"Int32","visibility":"Public","body":"@offset"}},{"html_id":"parent:String?-instance-method","name":"parent","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":48,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L48"},"def":{"name":"parent","return_type":"String | ::Nil","visibility":"Public","body":"@parent"}},{"html_id":"query_settings:Hash(String,String)?-instance-method","name":"query_settings","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":13,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L13"},"def":{"name":"query_settings","return_type":"Hash(String, String) | ::Nil","visibility":"Public","body":"@query_settings"}},{"html_id":"range(filter)-instance-method","name":"range","abstract":false,"args":[{"name":"filter","external_name":"filter","restriction":""}],"args_string":"(filter)","args_html":"(filter)","location":{"filename":"src/lucky_search/query.cr","line_number":129,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L129"},"def":{"name":"range","args":[{"name":"filter","external_name":"filter","restriction":""}],"visibility":"Public","body":"invalid_args = filter.values.flat_map(&.keys).reject do |k|\n  RANGE_PARAMS.includes?(k)\nend\ntransformed : RangeQuery = filter.transform_values do |filter_hash|\n  filter_hash.transform_values do |__arg4|\n    __arg4.as(RangeValue)\n  end\nend\nif invalid_args.empty?\nelse\n  raise(Error::MalformedQuery.new(\"Invalid range query arguments: #{invalid_args.join(\",\")}\"))\nend\nself.range.merge!(transformed)\nself\n"}},{"html_id":"range:RangeQuery-instance-method","name":"range","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":87,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L87"},"def":{"name":"range","return_type":"RangeQuery","visibility":"Public","body":"if (value = @range).nil?\n  @range = (RangeQuery.new)\nelse\n  value\nend"}},{"html_id":"search:String-instance-method","name":"search","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":7,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L7"},"def":{"name":"search","return_type":"String","visibility":"Public","body":"@search"}},{"html_id":"search_field(field)-instance-method","name":"search_field","abstract":false,"args":[{"name":"field","external_name":"field","restriction":""}],"args_string":"(field)","args_html":"(field)","location":{"filename":"src/lucky_search/query.cr","line_number":42,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L42"},"def":{"name":"search_field","args":[{"name":"field","external_name":"field","restriction":""}],"visibility":"Public","body":"fields.unshift(field)\nself\n"}},{"html_id":"should(filters:Filter)-instance-method","name":"should","doc":"Like filter, but at least one should match in absence of `filter`/`must` hits","summary":"<p>Like filter, but at least one should match in absence of <code><a href=\"../LuckySearch/Query.html#filter%28filters%3AFilter%29-instance-method\">#filter</a></code>/<code><a href=\"../LuckySearch/Query.html#must%3AFilter-instance-method\">#must</a></code> hits</p>","abstract":false,"args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"args_string":"(filters : Filter)","args_html":"(filters : <a href=\"../LuckySearch/Query/Filter.html\">Filter</a>)","location":{"filename":"src/lucky_search/query.cr","line_number":98,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L98"},"def":{"name":"should","args":[{"name":"filters","external_name":"filters","restriction":"Filter"}],"visibility":"Public","body":"self.should.merge!(filters)\nself\n"}},{"html_id":"should:Filter-instance-method","name":"should","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":75,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L75"},"def":{"name":"should","return_type":"Filter","visibility":"Public","body":"if (value = @should).nil?\n  @should = (Filter.new)\nelse\n  value\nend"}},{"html_id":"sort(sort:Sort)-instance-method","name":"sort","abstract":false,"args":[{"name":"sort","external_name":"sort","restriction":"Sort"}],"args_string":"(sort : Sort)","args_html":"(sort : <a href=\"../LuckySearch/Query/Sort.html\">Sort</a>)","location":{"filename":"src/lucky_search/query.cr","line_number":118,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L118"},"def":{"name":"sort","args":[{"name":"sort","external_name":"sort","restriction":"Sort"}],"visibility":"Public","body":"self.sort << sort\nself\n"}},{"html_id":"sort:Array(Sort)-instance-method","name":"sort","abstract":false,"location":{"filename":"src/lucky_search/query.cr","line_number":15,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L15"},"def":{"name":"sort","return_type":"Array(Sort)","visibility":"Public","body":"@sort"}}],"types":[{"html_id":"lucky_search/LuckySearch/Query/Filter","path":"LuckySearch/Query/Filter.html","kind":"alias","full_name":"LuckySearch::Query::Filter","name":"Filter","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":5,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L5"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"Hash(String, Array(Bool) | Array(Float32) | Array(Int32) | Array(String) | Nil)","aliased_html":"Hash(String, Array(Bool) | Array(Float32) | Array(Int32) | Array(String) | Nil)","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}},{"html_id":"lucky_search/LuckySearch/Query/FilterTerm","path":"LuckySearch/Query/FilterTerm.html","kind":"alias","full_name":"LuckySearch::Query::FilterTerm","name":"FilterTerm","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":286,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L286"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"Hash(String, Bool | Float32 | Int32 | String)","aliased_html":"Hash(String, Bool | Float32 | Int32 | String)","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}},{"html_id":"lucky_search/LuckySearch/Query/FilterValue","path":"LuckySearch/Query/FilterValue.html","kind":"alias","full_name":"LuckySearch::Query::FilterValue","name":"FilterValue","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":4,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L4"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"(Array(Bool) | Array(Float32) | Array(Int32) | Array(String) | Nil)","aliased_html":"Array(Bool) | Array(Float32) | Array(Int32) | Array(String) | Nil","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}},{"html_id":"lucky_search/LuckySearch/Query/RangeQuery","path":"LuckySearch/Query/RangeQuery.html","kind":"alias","full_name":"LuckySearch::Query::RangeQuery","name":"RangeQuery","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":124,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L124"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"Hash(String, Hash(Symbol, Bool | Float32 | Int32 | String))","aliased_html":"Hash(String, Hash(Symbol, Bool | Float32 | Int32 | String))","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}},{"html_id":"lucky_search/LuckySearch/Query/RangeValue","path":"LuckySearch/Query/RangeValue.html","kind":"alias","full_name":"LuckySearch::Query::RangeValue","name":"RangeValue","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":125,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L125"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"(Bool | Float32 | Int32 | String)","aliased_html":"Bool | Float32 | Int32 | String","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}},{"html_id":"lucky_search/LuckySearch/Query/Sort","path":"LuckySearch/Query/Sort.html","kind":"alias","full_name":"LuckySearch::Query::Sort","name":"Sort","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":3,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L3"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"(Hash(String, NamedTuple(order: Symbol)) | Hash(String, String) | String)","aliased_html":"Hash(String, {order: Symbol}) | Hash(String, String) | String","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}},{"html_id":"lucky_search/LuckySearch/Query/Subfilter","path":"LuckySearch/Query/Subfilter.html","kind":"alias","full_name":"LuckySearch::Query::Subfilter","name":"Subfilter","abstract":false,"locations":[{"filename":"src/lucky_search/query.cr","line_number":271,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/query.cr#L271"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"Hash(Symbol, Hash(String, Bool | Float32 | Int32 | String))","aliased_html":"Hash(Symbol, Hash(String, Bool | Float32 | Int32 | String))","const":false,"namespace":{"html_id":"lucky_search/LuckySearch/Query","kind":"class","full_name":"LuckySearch::Query","name":"Query"}}]},{"html_id":"lucky_search/LuckySearch/RecordIndexer","path":"LuckySearch/RecordIndexer.html","kind":"class","full_name":"LuckySearch::RecordIndexer","name":"RecordIndexer","abstract":false,"superclass":{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/record_indexer.cr","line_number":4,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L4"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"class_methods":[{"html_id":"document_name(klass:Class):String-class-method","name":"document_name","abstract":false,"args":[{"name":"klass","external_name":"klass","restriction":"Class"}],"args_string":"(klass : Class) : String","args_html":"(klass : Class) : String","location":{"filename":"src/lucky_search/record_indexer.cr","line_number":24,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L24"},"def":{"name":"document_name","args":[{"name":"klass","external_name":"klass","restriction":"Class"}],"return_type":"String","visibility":"Public","body":"Utils.document_name(klass)"}},{"html_id":"index(klass:Class,id,search_data)-class-method","name":"index","abstract":false,"args":[{"name":"klass","external_name":"klass","restriction":"Class"},{"name":"id","external_name":"id","restriction":""},{"name":"search_data","external_name":"search_data","restriction":""}],"args_string":"(klass : Class, id, search_data)","args_html":"(klass : Class, id, search_data)","location":{"filename":"src/lucky_search/record_indexer.cr","line_number":28,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L28"},"def":{"name":"index","args":[{"name":"klass","external_name":"klass","restriction":"Class"},{"name":"id","external_name":"id","restriction":""},{"name":"search_data","external_name":"search_data","restriction":""}],"visibility":"Public","body":"document_name = document_name(klass)\n(new(document_name, id, search_data)).index_record\n"}},{"html_id":"remove(klass:Class,id,search_data)-class-method","name":"remove","abstract":false,"args":[{"name":"klass","external_name":"klass","restriction":"Class"},{"name":"id","external_name":"id","restriction":""},{"name":"search_data","external_name":"search_data","restriction":""}],"args_string":"(klass : Class, id, search_data)","args_html":"(klass : Class, id, search_data)","location":{"filename":"src/lucky_search/record_indexer.cr","line_number":33,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L33"},"def":{"name":"remove","args":[{"name":"klass","external_name":"klass","restriction":"Class"},{"name":"id","external_name":"id","restriction":""},{"name":"search_data","external_name":"search_data","restriction":""}],"visibility":"Public","body":"document_name = document_name(klass)\n(new(document_name, id, search_data)).remove_record\n"}}],"constructors":[{"html_id":"new(document_name,id,search_data)-class-method","name":"new","abstract":false,"args":[{"name":"document_name","external_name":"document_name","restriction":""},{"name":"id","external_name":"id","restriction":""},{"name":"search_data","external_name":"search_data","restriction":""}],"args_string":"(document_name, id, search_data)","args_html":"(document_name, id, search_data)","location":{"filename":"src/lucky_search/record_indexer.cr","line_number":19,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L19"},"def":{"name":"new","args":[{"name":"document_name","external_name":"document_name","restriction":""},{"name":"id","external_name":"id","restriction":""},{"name":"search_data","external_name":"search_data","restriction":""}],"visibility":"Public","body":"_ = allocate\n_.initialize(document_name, id, search_data)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"html_id":"new(document_name)-class-method","name":"new","abstract":false,"args":[{"name":"document_name","external_name":"document_name","restriction":""}],"args_string":"(document_name)","args_html":"(document_name)","location":{"filename":"src/lucky_search/record_indexer.cr","line_number":13,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L13"},"def":{"name":"new","args":[{"name":"document_name","external_name":"document_name","restriction":""}],"visibility":"Public","body":"_ = allocate\n_.initialize(document_name)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"client:Elastic-instance-method","name":"client","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":11,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L11"},"def":{"name":"client","return_type":"Elastic","visibility":"Public","body":"@client"}},{"html_id":"create_index-instance-method","name":"create_index","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":59,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L59"},"def":{"name":"create_index","visibility":"Public","body":"schema = Schema.generate_schema(search_data)\nclient.create_index(document_name, schema)\n"}},{"html_id":"document_name:String-instance-method","name":"document_name","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":5,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L5"},"def":{"name":"document_name","return_type":"String","visibility":"Public","body":"@document_name"}},{"html_id":"id:Int64|UUID-instance-method","name":"id","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":6,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L6"},"def":{"name":"id","return_type":"Int64 | UUID","visibility":"Public","body":"@id"}},{"html_id":"index_document-instance-method","name":"index_document","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":51,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L51"},"def":{"name":"index_document","visibility":"Public","body":"if client.exists?(document_name, id)\n  client.update(document_name, id, search_data)\nelse\n  client.update(document_name, id, search_data)\nend"}},{"html_id":"index_record-instance-method","name":"index_record","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":42,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L42"},"def":{"name":"index_record","visibility":"Public","body":"if client.index_exists?(document_name)\n  index_document\nelse\n  create_index\n  index_document\nend"}},{"html_id":"remove_record-instance-method","name":"remove_record","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":38,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L38"},"def":{"name":"remove_record","visibility":"Public","body":"client.delete(document_name, id)"}},{"html_id":"search_data:Hash(String,SearchValue)-instance-method","name":"search_data","doc":"the data to index","summary":"<p>the data to index</p>","abstract":false,"location":{"filename":"src/lucky_search/record_indexer.cr","line_number":9,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/record_indexer.cr#L9"},"def":{"name":"search_data","return_type":"Hash(String, SearchValue)","visibility":"Public","body":"@search_data"}}]},{"html_id":"lucky_search/LuckySearch/Schema","path":"LuckySearch/Schema.html","kind":"class","full_name":"LuckySearch::Schema","name":"Schema","abstract":false,"superclass":{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/schema.cr","line_number":2,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L2"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"class_methods":[{"html_id":"analysis-class-method","name":"analysis","doc":"analysis from searchkick","summary":"<p>analysis from searchkick</p>","abstract":false,"location":{"filename":"src/lucky_search/schema.cr","line_number":59,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L59"},"def":{"name":"analysis","visibility":"Public","body":"{analyzer: {searchkick_keyword: {type: \"custom\", tokenizer: \"keyword\", filter: [\"lowercase\"]}, default_analyzer: {type: \"custom\", char_filter: [\"ampersand\"], tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_index_shingle\", \"searchkick_stemmer\"]}, searchkick_search: {type: \"custom\", char_filter: [\"ampersand\"], tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_search_shingle\", \"searchkick_stemmer\"]}, searchkick_search2: {type: \"custom\", char_filter: [\"ampersand\"], tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_stemmer\"]}, searchkick_autocomplete_search: {type: \"custom\", tokenizer: \"keyword\", filter: [\"lowercase\", \"asciifolding\"]}, searchkick_word_search: {type: \"custom\", tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\"]}, searchkick_suggest_index: {type: \"custom\", tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_suggest_shingle\"]}, searchkick_text_start_index: {type: \"custom\", tokenizer: \"keyword\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_edge_ngram\"]}, searchkick_text_middle_index: {type: \"custom\", tokenizer: \"keyword\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_ngram\"]}, searchkick_text_end_index: {type: \"custom\", tokenizer: \"keyword\", filter: [\"lowercase\", \"asciifolding\", \"reverse\", \"searchkick_edge_ngram\", \"reverse\"]}, searchkick_word_start_index: {type: \"custom\", tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_edge_ngram\"]}, searchkick_word_middle_index: {type: \"custom\", tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"searchkick_ngram\"]}, searchkick_word_end_index: {type: \"custom\", tokenizer: \"standard\", filter: [\"lowercase\", \"asciifolding\", \"reverse\", \"searchkick_edge_ngram\", \"reverse\"]}}, filter: {searchkick_index_shingle: {type: \"shingle\", token_separator: \"\"}, searchkick_search_shingle: {type: \"shingle\", token_separator: \"\", output_unigrams: false, output_unigrams_if_no_shingles: true}, searchkick_suggest_shingle: {type: \"shingle\", max_shingle_size: 5}, searchkick_edge_ngram: {type: \"edge_ngram\", min_gram: 1, max_gram: 50}, searchkick_ngram: {type: \"ngram\", min_gram: 1, max_gram: 50}, searchkick_stemmer: {type: language == language.to_s.downcase ? \"stemmer\" : \"snowball\", language: language}}, char_filter: {ampersand: {type: \"mapping\", mappings: [\"&=> and \"]}}}"}},{"html_id":"field_type(value)-class-method","name":"field_type","abstract":false,"args":[{"name":"value","external_name":"value","restriction":""}],"args_string":"(value)","args_html":"(value)","location":{"filename":"src/lucky_search/schema.cr","line_number":41,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L41"},"def":{"name":"field_type","args":[{"name":"value","external_name":"value","restriction":""}],"visibility":"Public","body":"case value\nwhen String\n  \"text\"\nwhen Int\n  \"integer\"\nwhen Float\n  \"float\"\nwhen Time\n  \"date\"\nwhen Bool\n  \"boolean\"\nelse\n  \"text\"\nend"}},{"html_id":"generate_field_type(search_data)-class-method","name":"generate_field_type","abstract":false,"args":[{"name":"search_data","external_name":"search_data","restriction":""}],"args_string":"(search_data)","args_html":"(search_data)","location":{"filename":"src/lucky_search/schema.cr","line_number":31,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L31"},"def":{"name":"generate_field_type","args":[{"name":"search_data","external_name":"search_data","restriction":""}],"visibility":"Public","body":"new_data = {} of String => Hash(String, String)\nsearch_data.each do |key, value|\n  new_data[key] = {\"type\" => field_type(value)}\nend\nnew_data\n"}},{"html_id":"generate_schema(search_data)-class-method","name":"generate_schema","abstract":false,"args":[{"name":"search_data","external_name":"search_data","restriction":""}],"args_string":"(search_data)","args_html":"(search_data)","location":{"filename":"src/lucky_search/schema.cr","line_number":5,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L5"},"def":{"name":"generate_schema","args":[{"name":"search_data","external_name":"search_data","restriction":""}],"visibility":"Public","body":"mappings = generate_field_type(search_data)\nsettings = {\"number_of_shards\" => 1, \"number_of_replicas\" => 1, \"index\" => {\"max_ngram_diff\" => 49, \"max_shingle_diff\" => 4}, \"analysis\" => analysis}\nif LuckyEnv.test?\n  settings[\"number_of_shards\"] = 1\n  settings[\"number_of_replicas\"] = 0\nend\n{\"settings\" => settings, \"mappings\" => {\"properties\" => mappings}}\n"}},{"html_id":"language-class-method","name":"language","abstract":false,"location":{"filename":"src/lucky_search/schema.cr","line_number":3,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/schema.cr#L3"},"def":{"name":"language","visibility":"Public","body":"@@language"}}]},{"html_id":"lucky_search/LuckySearch/SearchValue","path":"LuckySearch/SearchValue.html","kind":"alias","full_name":"LuckySearch::SearchValue","name":"SearchValue","abstract":false,"locations":[{"filename":"src/lucky_search/types.cr","line_number":2,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/types.cr#L2"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":true,"aliased":"(Bool | Float32 | Float64 | Int32 | Int64 | String | Time | UUID | Nil)","aliased_html":"Bool | Float32 | Float64 | Int32 | Int64 | String | Time | UUID | Nil","const":false,"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"}},{"html_id":"lucky_search/LuckySearch/SimpleQuery","path":"LuckySearch/SimpleQuery.html","kind":"class","full_name":"LuckySearch::SimpleQuery(T, K)","name":"SimpleQuery","abstract":false,"superclass":{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"lucky_search/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"lucky_search/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/lucky_search/simple_query.cr","line_number":4,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L4"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"COUNT","name":"COUNT","value":"\"count\""},{"id":"HITS","name":"HITS","value":"\"hits\""},{"id":"ID","name":"ID","value":"\"_id\""},{"id":"SCORE","name":"SCORE","value":"[\"_score\"]"},{"id":"SOURCE","name":"SOURCE","value":"\"_source\""},{"id":"TOTAL","name":"TOTAL","value":"\"total\""},{"id":"TYPE","name":"TYPE","value":"\"_document_type\""},{"id":"VALUE","name":"VALUE","value":"\"value\""}],"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"constructors":[{"html_id":"new(elastic_index:String?=nil,document_name:String?=nil)-class-method","name":"new","abstract":false,"args":[{"name":"elastic_index","default_value":"nil","external_name":"elastic_index","restriction":"String | ::Nil"},{"name":"document_name","default_value":"nil","external_name":"document_name","restriction":"String | ::Nil"}],"args_string":"(elastic_index : String? = nil, document_name : String? = nil)","args_html":"(elastic_index : String? = <span class=\"n\">nil</span>, document_name : String? = <span class=\"n\">nil</span>)","location":{"filename":"src/lucky_search/simple_query.cr","line_number":21,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L21"},"def":{"name":"new","args":[{"name":"elastic_index","default_value":"nil","external_name":"elastic_index","restriction":"String | ::Nil"},{"name":"document_name","default_value":"nil","external_name":"document_name","restriction":"String | ::Nil"}],"visibility":"Public","body":"_ = SimpleQuery(T, K).allocate\n_.initialize(elastic_index, document_name)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"client-instance-method","name":"client","doc":"Yields the elasticsearch client","summary":"<p>Yields the elasticsearch client</p>","abstract":false,"location":{"filename":"src/lucky_search/simple_query.cr","line_number":27,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L27"},"def":{"name":"client","visibility":"Public","body":"if (value = @client).nil?\n  @client = (LuckySearch::Elastic.new)\nelse\n  value\nend"}},{"html_id":"count(builder)-instance-method","name":"count","doc":"Performs a count query against an index","summary":"<p>Performs a count query against an index</p>","abstract":false,"args":[{"name":"builder","external_name":"builder","restriction":""}],"args_string":"(builder)","args_html":"(builder)","location":{"filename":"src/lucky_search/simple_query.cr","line_number":50,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L50"},"def":{"name":"count","args":[{"name":"builder","external_name":"builder","restriction":""}],"visibility":"Public","body":"query = generate_body(builder)\nbody = query[:body].to_h.reject(:from, :size, :sort)\nsimplified = query.merge({body: body})\n(client.count(simplified))[COUNT].as_i\n"}},{"html_id":"elastic_document_name:String-instance-method","name":"elastic_document_name","doc":"Document type defaults to class name without namespace","summary":"<p>Document type defaults to class name without namespace</p>","abstract":false,"location":{"filename":"src/lucky_search/simple_query.cr","line_number":19,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L19"},"def":{"name":"elastic_document_name","return_type":"String","visibility":"Public","body":"@elastic_document_name"}},{"html_id":"elastic_index:String-instance-method","name":"elastic_index","doc":"Index defaults to avram table name","summary":"<p>Index defaults to avram table name</p>","abstract":false,"location":{"filename":"src/lucky_search/simple_query.cr","line_number":16,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L16"},"def":{"name":"elastic_index","return_type":"String","visibility":"Public","body":"@elastic_index"}},{"html_id":"generate_body(builder)-instance-method","name":"generate_body","abstract":false,"args":[{"name":"builder","external_name":"builder","restriction":""}],"args_string":"(builder)","args_html":"(builder)","location":{"filename":"src/lucky_search/simple_query.cr","line_number":112,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L112"},"def":{"name":"generate_body","args":[{"name":"builder","external_name":"builder","restriction":""}],"visibility":"Public","body":"opt = builder.build\nindex = builder.index || elastic_index\nquery = opt[:query]\nfilter = opt[:filter]\nsort = (opt[:sort]? || ([] of Array(String))) + SCORE\nquery_context = {bool: filter ? query.merge(filter) : query}\n{index: index, body: {query: query_context, sort: sort, from: opt[:offset], size: opt[:limit]}}\n"}},{"html_id":"query(q:String,params={}ofSymbol=>String,filters=nil)-instance-method","name":"query","abstract":false,"args":[{"name":"q","external_name":"q","restriction":"String"},{"name":"params","default_value":"{} of Symbol => String","external_name":"params","restriction":""},{"name":"filters","default_value":"nil","external_name":"filters","restriction":""}],"args_string":"(q : String, params = {} of Symbol => String, filters = nil)","args_html":"(q : String, params = {} <span class=\"k\">of</span> <span class=\"t\">Symbol</span> =&gt; <span class=\"t\">String</span>, filters = <span class=\"n\">nil</span>)","location":{"filename":"src/lucky_search/simple_query.cr","line_number":39,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L39"},"def":{"name":"query","args":[{"name":"q","external_name":"q","restriction":"String"},{"name":"params","default_value":"{} of Symbol => String","external_name":"params","restriction":""},{"name":"filters","default_value":"nil","external_name":"filters","restriction":""}],"visibility":"Public","body":"params[:q] = q\nbuilder = Query.new(params)\nif filters.nil?\nelse\n  builder.filter(filters)\nend\nbuilder.filter({TYPE => [elastic_document_name]})\nbuilder\n"}},{"html_id":"query(params={}ofSymbol=>String,filters=nil)-instance-method","name":"query","doc":"Safely build the query","summary":"<p>Safely build the query</p>","abstract":false,"args":[{"name":"params","default_value":"{} of Symbol => String","external_name":"params","restriction":""},{"name":"filters","default_value":"nil","external_name":"filters","restriction":""}],"args_string":"(params = {} of Symbol => String, filters = nil)","args_html":"(params = {} <span class=\"k\">of</span> <span class=\"t\">Symbol</span> =&gt; <span class=\"t\">String</span>, filters = <span class=\"n\">nil</span>)","location":{"filename":"src/lucky_search/simple_query.cr","line_number":30,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L30"},"def":{"name":"query","args":[{"name":"params","default_value":"{} of Symbol => String","external_name":"params","restriction":""},{"name":"filters","default_value":"nil","external_name":"filters","restriction":""}],"visibility":"Public","body":"builder = Query.new(params)\nif filters.nil?\nelse\n  builder.filter(filters)\nend\nbuilder.filter({TYPE => [elastic_document_name]})\nbuilder\n"}},{"html_id":"search(builder)-instance-method","name":"search","doc":"Query elasticsearch with a query builder object","summary":"<p>Query elasticsearch with a query builder object</p>","abstract":false,"args":[{"name":"builder","external_name":"builder","restriction":""}],"args_string":"(builder)","args_html":"(builder)","location":{"filename":"src/lucky_search/simple_query.cr","line_number":60,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L60"},"def":{"name":"search","args":[{"name":"builder","external_name":"builder","restriction":""}],"visibility":"Public","body":"_search(builder)"}},{"html_id":"search(builder,&block:Proc(T,T?))-instance-method","name":"search","doc":"Query elasticsearch with a query builder object, accepts a formatter block\nAllows annotation/conversion of records using data from the model.\nNils are removed from the list.","summary":"<p>Query elasticsearch with a query builder object, accepts a formatter block Allows annotation/conversion of records using data from the model.</p>","abstract":false,"args":[{"name":"builder","external_name":"builder","restriction":""}],"args_string":"(builder, &block : Proc(T, T?))","args_html":"(builder, &block : Proc(T, T?))","location":{"filename":"src/lucky_search/simple_query.cr","line_number":67,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/simple_query.cr#L67"},"def":{"name":"search","args":[{"name":"builder","external_name":"builder","restriction":""}],"yields":0,"block_arg":{"name":"block","external_name":"block","restriction":"Proc(T, T | ::Nil)"},"visibility":"Public","body":"_search(builder, block)"}}]},{"html_id":"lucky_search/LuckySearch/Utils","path":"LuckySearch/Utils.html","kind":"module","full_name":"LuckySearch::Utils","name":"Utils","abstract":false,"locations":[{"filename":"src/lucky_search/utils.cr","line_number":2,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/utils.cr#L2"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"lucky_search/LuckySearch","kind":"module","full_name":"LuckySearch","name":"LuckySearch"},"class_methods":[{"html_id":"document_name(klass:Class)-class-method","name":"document_name","abstract":false,"args":[{"name":"klass","external_name":"klass","restriction":"Class"}],"args_string":"(klass : Class)","args_html":"(klass : Class)","location":{"filename":"src/lucky_search/utils.cr","line_number":3,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/utils.cr#L3"},"def":{"name":"document_name","args":[{"name":"klass","external_name":"klass","restriction":"Class"}],"visibility":"Public","body":"Wordsmith::Inflector.pluralize(\"#{LuckyEnv.environment}_#{(klass.name.gsub(\"::\", \"\")).underscore}\")"}},{"html_id":"document_name(klass:String)-class-method","name":"document_name","abstract":false,"args":[{"name":"klass","external_name":"klass","restriction":"String"}],"args_string":"(klass : String)","args_html":"(klass : String)","location":{"filename":"src/lucky_search/utils.cr","line_number":7,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/utils.cr#L7"},"def":{"name":"document_name","args":[{"name":"klass","external_name":"klass","restriction":"String"}],"visibility":"Public","body":"Wordsmith::Inflector.pluralize(\"#{LuckyEnv.environment}_#{(klass.gsub(\"::\", \"\")).underscore}\")"}}]}]},{"html_id":"lucky_search/Searchable","path":"Searchable.html","kind":"module","full_name":"Searchable","name":"Searchable","abstract":false,"locations":[{"filename":"src/lucky_search/searchable.cr","line_number":1,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/searchable.cr#L1"}],"repository_name":"lucky_search","program":false,"enum":false,"alias":false,"const":false,"instance_methods":[{"html_id":"index_record(saved_record)-instance-method","name":"index_record","abstract":false,"args":[{"name":"saved_record","external_name":"saved_record","restriction":""}],"args_string":"(saved_record)","args_html":"(saved_record)","location":{"filename":"src/lucky_search/searchable.cr","line_number":11,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/searchable.cr#L11"},"def":{"name":"index_record","args":[{"name":"saved_record","external_name":"saved_record","restriction":""}],"visibility":"Public","body":"LuckySearch::RecordIndexer.index(saved_record.class, saved_record.id, saved_record.search_data)"}},{"html_id":"remove_record(deleted_record)-instance-method","name":"remove_record","abstract":false,"args":[{"name":"deleted_record","external_name":"deleted_record","restriction":""}],"args_string":"(deleted_record)","args_html":"(deleted_record)","location":{"filename":"src/lucky_search/searchable.cr","line_number":7,"url":"https://github.com/confact/lucky_search/blob/22983d1dccd89878306398631b0495b6e1be4d04/src/lucky_search/searchable.cr#L7"},"def":{"name":"remove_record","args":[{"name":"deleted_record","external_name":"deleted_record","restriction":""}],"visibility":"Public","body":"LuckySearch::RecordIndexer.remove(deleted_record.class, deleted_record.id, deleted_record.search_data)"}}]}]}})